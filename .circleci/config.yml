version: 2.1

jobs:
  build_with_image:
    parameters:
      image:
        type: string
    docker:
      - image: << parameters.image >>
    steps:
      - checkout
      - run: 
          name: Swift Test
          command: swift test
      - run:
          name: Swift build Release
          command: swift build -c release -Xswiftc -static-stdlib     

workflows:
  workflow:
    jobs:
      - build_with_image:
          name: swift-5.0-branch
          image: norionomura/swift:swift-5.0-branch

# https://github.com/norio-nomura/SwiftBacktrace/blob/master/.circleci/config.yml