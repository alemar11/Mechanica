matrix:
  include:
    - os: linux
      dist: trusty
      sudo: required
      language: generic
    - os: osx
      osx_image: xcode9.1
      language: objective-c
      sudo: required
      env:
        global:
        - LC_CTYPE=en_US.UTF-8
        - LANG=en_US.UTF-8
        - IOS_FRAMEWORK_SCHEME="Mechanica iOS"
        - MACOS_FRAMEWORK_SCHEME="Mechanica macOS"
        - TVOS_FRAMEWORK_SCHEME="Mechanica tvOS"
        - WATCHOS_FRAMEWORK_SCHEME="Mechanica watchOS"
        - IOS_SDK=iphonesimulator11.1
        - MACOS_SDK=macosx10.13
        - TVOS_SDK=appletvsimulator11.1
        - WATCHOS_SDK=watchsimulator4.1
        #- WORKSPACE=Mechanica.xcworkspace
        #- EXAMPLE_SCHEME="Mechanica Example"
        
        matrix:
          # - DESTINATION="OS=10.3.1,name=iPhone 5"             SCHEME="$IOS_FRAMEWORK_SCHEME"     SDK="$IOS_SDK"     RUN_TESTS="YES"   POD_LINT="YES"  CODECOV_FLAG="ios10-32bit"  SWIFT_PACKAGE="NO"
          # - DESTINATION="OS=10.3.1,name=iPhone 7 Plus"        SCHEME="$IOS_FRAMEWORK_SCHEME"     SDK="$IOS_SDK"     RUN_TESTS="YES"   POD_LINT="NO"   CODECOV_FLAG="ios10"        SWIFT_PACKAGE="NO"  
          # - DESTINATION="OS=3.2,name=Apple Watch - 42mm"      SCHEME="$WATCHOS_FRAMEWORK_SCHEME" SDK="$WATCHOS_SDK" RUN_TESTS="NO"    POD_LINT="NO"   CODECOV_FLAG="watchos3"     SWIFT_PACKAGE="NO"
          # - DESTINATION="OS=10.2,name=Apple TV 1080p"         SCHEME="$TVOS_FRAMEWORK_SCHEME"    SDK="$TVOS_SDK"    RUN_TESTS="YES"   POD_LINT="NO"   CODECOV_FLAG="tvos10"       SWIFT_PACKAGE="NO"
          # - DESTINATION="arch=x86_64"                         SCHEME="$MACOS_FRAMEWORK_SCHEME"   SDK="$MACOS_SDK"   RUN_TESTS="YES"   POD_LINT="NO"   CODECOV_FLAG="macos10_12"   SWIFT_PACKAGE="NO"

          - DESTINATION="OS=11.1,name=iPhone X"               SCHEME="$IOS_FRAMEWORK_SCHEME"      SDK="$IOS_SDK"      RUN_TESTS="YES"   POD_LINT="YES"   CODECOV_FLAG="ios"       SWIFT_PACKAGE="YES"
          # - DESTINATION="OS=4.1,name=Apple Watch - 42mm"      SCHEME="$WATCHOS_FRAMEWORK_SCHEME"  SDK="$WATCHOS_SDK"  RUN_TESTS="NO"    POD_LINT="NO"    CODECOV_FLAG="watchos"   SWIFT_PACKAGE="NO"  
          # - DESTINATION="OS=11.1,name=Apple TV 4K (at 1080p)" SCHEME="$TVOS_FRAMEWORK_SCHEME"     SDK="$TVOS_SDK"     RUN_TESTS="YES"   POD_LINT="NO"    CODECOV_FLAG="tvos"      SWIFT_PACKAGE="NO"
          # - DESTINATION="arch=x86_64"     

install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      eval "$(curl -sL https://swiftenv.fuller.li/install.sh)";
    fi  

script:
  - swift build
  - swift test      